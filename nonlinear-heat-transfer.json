{"version":2,"kind":"Notebook","sha256":"cdef4afe59bffabf53564ebda71bd8aeaf268badc48df938b54bba8af2192613","slug":"nonlinear-heat-transfer","location":"/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","dependencies":[],"frontmatter":{"title":"Stationary nonlinear heat transfer","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery","math":{"\\tens":{"macro":"\\underline{\\underline{#1}}"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery/blob/main/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","edit_url":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery/edit/main/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","exports":[{"format":"ipynb","filename":"nonlinear_heat_transfer.ipynb","url":"/fenicsx-mfront-gallery/build/nonlinear_heat_trans-5302cd136755395095281a79d1606d22.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This demo shows how to use a simple ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dTD5SpPuzW"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OJfeYzi3V6"},{"type":"text","value":" behaviour to solve a non-linear sationary heat transfer equation with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IvG46UB6fU"},{"type":"inlineCode","value":"dolfinx_materials","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VJiwRJjJLg"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xRjUwAjOxL"}],"key":"rUiBVD1Xr4"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Description of the non-linear constitutive heat transfer law","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TVz7MVafms"}],"identifier":"description-of-the-non-linear-constitutive-heat-transfer-law","label":"Description of the non-linear constitutive heat transfer law","html_id":"description-of-the-non-linear-constitutive-heat-transfer-law","implicit":true,"key":"fcYKhFRx4g"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The thermal material is described by the following non linear Fourier\nLaw:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pmkHPDUcQu"}],"key":"dNpIuG3hVN"},{"type":"math","value":"\\mathbf{j}=-k\\left(T\\right)\\,\\mathbf{\\nabla} T","position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">j</mi><mo>=</mo><mo>−</mo><mi>k</mi><mrow><mo fence=\"true\">(</mo><mi>T</mi><mo fence=\"true\">)</mo></mrow><mtext> </mtext><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}=-k\\left(T\\right)\\,\\mathbf{\\nabla} T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span>","enumerator":"1","key":"XHC9HnKjyW"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vfYSdYvkQj"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span></span></span></span>","key":"J4sydupEcy"},{"type":"text","value":" is the heat flux and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"YZGDraMeys"},{"type":"inlineMath","value":"\\mathbf{\\nabla} T","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{\\nabla} T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"lNy10tX1Oo"},{"type":"text","value":" is the\ntemperature gradient.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jzRg4UQN7q"}],"key":"lusjT1C0li"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Expression of the thermal conductivity","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ZW8S1TkT3n"}],"identifier":"expression-of-the-thermal-conductivity","label":"Expression of the thermal conductivity","html_id":"expression-of-the-thermal-conductivity","implicit":true,"key":"g2NRu0WN9k"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The thermal conductivity is assumed to be given by:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LWfI0YddH1"}],"key":"gLcEHgwTfr"},{"type":"math","value":"k\\left(T\\right)={\\displaystyle \\frac{\\displaystyle 1}{\\displaystyle A+B\\,T}}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>k</mi><mrow><mo fence=\"true\">(</mo><mi>T</mi><mo fence=\"true\">)</mo></mrow><mo>=</mo><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mn>1</mn></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>A</mi><mo>+</mo><mi>B</mi><mtext> </mtext><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">k\\left(T\\right)={\\displaystyle \\frac{\\displaystyle 1}{\\displaystyle A+B\\,T}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></span>","enumerator":"2","key":"OJTSyzB6CE"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"This expression accounts for the phononic contribution to the thermal\nconductivity.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rw52E4NNen"}],"key":"Usy3V5hg8k"},{"type":"heading","depth":3,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Derivatives","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"eOqiYckKCi"}],"identifier":"derivatives","label":"Derivatives","html_id":"derivatives","implicit":true,"key":"xWHfFAOfUd"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"As discussed below, the consistent linearisation of the heat transfer\nequilibrium requires to compute:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"gJdsRS6tl2"}],"key":"OfJGfLSUSk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the derivative\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"xVAwHePLNX"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","key":"yodnIKWRXH"},{"type":"text","value":"\nof the heat flux with respect to the temperature gradient.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"sTkZBw26zj"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","key":"gd7Bam9u1s"},{"type":"text","value":"\nis given by: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"HUODFDOpBs"}],"key":"HEIH6CGMgb"},{"type":"math","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}=-k\\left(T\\right)\\,I","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mstyle></mfrac></mstyle><mo>=</mo><mo>−</mo><mi>k</mi><mrow><mo fence=\"true\">(</mo><mi>T</mi><mo fence=\"true\">)</mo></mrow><mtext> </mtext><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}=-k\\left(T\\right)\\,I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span>","enumerator":"3","key":"Fi9MyFnVwL"}],"key":"NDrwhitW9e"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the derivative\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"AkV8WSETOa"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","key":"qWthzPbYw1"},{"type":"text","value":"\nof the heat flux with respect to the temperature.\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"wDtuR9KAYv"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","key":"GupJp4EogZ"},{"type":"text","value":"\nis given by: ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"IeTl1kk1dA"}],"key":"JfaxVA4efx"},{"type":"math","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}=-{\\displaystyle \\frac{\\displaystyle \\partial k\\left(T\\right)}{\\displaystyle \\partial T}}\\,\\mathbf{\\nabla} T=B\\,k^{2}\\,\\mathbf{\\nabla} T","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi>T</mi></mstyle></mfrac></mstyle><mo>=</mo><mo>−</mo><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mfrac><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi>k</mi><mrow><mo fence=\"true\">(</mo><mi>T</mi><mo fence=\"true\">)</mo></mrow></mstyle><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi mathvariant=\"normal\">∂</mi><mi>T</mi></mstyle></mfrac></mstyle><mtext> </mtext><mi mathvariant=\"bold\">∇</mi><mi>T</mi><mo>=</mo><mi>B</mi><mtext> </mtext><msup><mi>k</mi><mn>2</mn></msup><mtext> </mtext><mi mathvariant=\"bold\">∇</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}=-{\\displaystyle \\frac{\\displaystyle \\partial k\\left(T\\right)}{\\displaystyle \\partial T}}\\,\\mathbf{\\nabla} T=B\\,k^{2}\\,\\mathbf{\\nabla} T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span>","enumerator":"4","key":"YGEbXd23lA"}],"key":"KxtThHXh2H"}],"key":"FgEmnEzWY7"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"inlineCode","value":"MFront","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"PQeNMcaPlq"},{"type":"text","value":" implementation","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"R27jinOjkq"}],"identifier":"mfront-implementation","label":"MFront implementation","html_id":"mfront-implementation","implicit":true,"key":"RD92pHSpJK"},{"type":"heading","depth":3,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Choice of the the domain specific language","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"YygdFSUkkv"}],"identifier":"choice-of-the-the-domain-specific-language","label":"Choice of the the domain specific language","html_id":"choice-of-the-the-domain-specific-language","implicit":true,"key":"wL6UWg7cvv"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Every ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"k6ovA5qamP"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"kc2eyZymwN"},{"type":"text","value":" file is handled by a domain specific language (DSL), which\naims at providing the most suitable abstraction for a particular choice\nof behaviour and integration algorithm. See ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"iKRjjdmulH"},{"type":"inlineCode","value":"mfront mfront --list-dsl","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"bFHsINJ4JY"},{"type":"text","value":"\nfor a list of the available DSLs.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"dzEhKILX4b"}],"key":"YyCY2vDuh2"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"The name of DSL’s handling generic behaviours ends with\n","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"u5iChDjbpa"},{"type":"inlineCode","value":"GenericBehaviour","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"HQMBGxC9TS"},{"type":"text","value":". The first part of a DSL’s name is related to the\nintegration algorithm used.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Y17EnWP5XV"}],"key":"WVPEKylz4r"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"In the case of this non linear transfer behaviour, the heat flux is\nexplicitly computed from the temperature and the temperature gradient.\nThe ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fSqkUKcGkf"},{"type":"inlineCode","value":"DefaultGenericBehaviour","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"kP8W4d7DAC"},{"type":"text","value":" is the most suitable choice:","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"rGbMOr4LQq"}],"key":"FiDhlI3c2x"},{"type":"code","lang":"cpp","value":"@DSL DefaultGenericBehaviour;","position":{"start":{"line":65,"column":1},"end":{"line":67,"column":1}},"key":"IUU8Ez1fJB"},{"type":"heading","depth":3,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Some metadata","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"lE6Oyy7mCX"}],"identifier":"some-metadata","label":"Some metadata","html_id":"some-metadata","implicit":true,"key":"xEQAmSVmfg"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"The following lines define the name of the behaviour, the name of the\nauthor and the date of its writing:","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"ogBAVft9J7"}],"key":"NwpgywLuIt"},{"type":"code","lang":"cpp","value":"@Behaviour StationaryHeatTransfer;\n@Author Thomas Helfer;\n@Date 15/02/2019;","position":{"start":{"line":74,"column":1},"end":{"line":78,"column":1}},"key":"ftOx1BpT4W"},{"type":"heading","depth":3,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Gradients and fluxes","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"ocAkQe5dSn"}],"identifier":"gradients-and-fluxes","label":"Gradients and fluxes","html_id":"gradients-and-fluxes","implicit":true,"key":"VUveFddqQI"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Generic behaviours relate pairs of gradients and fluxes. Gradients and\nfluxes are declared independently but the first declared gradient is\nassumed to be conjugated with the first declared fluxes and so on…","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"FXSUoltj4a"}],"key":"lQYFM0cuK3"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"The temperature gradient is declared as follows (note that Unicode characters are supported):","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"KmTb0GOah2"}],"key":"ta02OmhJhR"},{"type":"code","lang":"cpp","value":"@Gradient TemperatureGradient ∇T;\n∇T.setGlossaryName(\"TemperatureGradient\");","position":{"start":{"line":88,"column":1},"end":{"line":91,"column":1}},"key":"UZWpFxocks"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Note that we associated to ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"YtvQyctNDt"},{"type":"inlineCode","value":"∇T","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"NPCgYvH2fK"},{"type":"text","value":" the glossary name ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"r9vGwyOsGK"},{"type":"inlineCode","value":"TemperatureGradient","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"N8hwtZDroh"},{"type":"text","value":".\nThis is helpful for the calling code.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"BT5aMaNLOj"}],"key":"Ckgz54oIrj"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"After this declaration, the following variables will be defined:","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"hIEILlepBe"}],"key":"JLZ5yLKaFv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":98,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The temperature gradient ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"RcENDg5gFP"},{"type":"inlineCode","value":"∇T","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"DTwELNa5SL"},{"type":"text","value":" at the beginning of the time step.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"uvGZszdKIF"}],"key":"zlktO59VdQ"}],"key":"BJS0utPwuB"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The increment of the temperature gradient ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"aVMyHjKNh9"},{"type":"inlineCode","value":"Δ∇T","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"gXgM3NazqI"},{"type":"text","value":" over the time step.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"wvuAebGafC"}],"key":"CKqQEWEG1Z"}],"key":"lQSMnlvMdH"}],"key":"BCcaQqy8eq"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"The heat flux is then declared as follows:","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"iua5e5fttB"}],"key":"tNvlsZl7Ia"},{"type":"code","lang":"cpp","value":"@Flux HeatFlux j;\nj.setGlossaryName(\"HeatFlux\");","position":{"start":{"line":103,"column":1},"end":{"line":106,"column":1}},"key":"d3gmtw2E1a"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"In the following code blocks, ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"RZ2EZDWhJL"},{"type":"inlineCode","value":"j","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"IYFZ6uRCqx"},{"type":"text","value":" will be the heat flux at the end of\nthe time step.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"sdmsY5xJLj"}],"key":"D2aHMiv8lr"},{"type":"heading","depth":3,"position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Tangent operator blocks","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"QA2U9yyHHy"}],"identifier":"tangent-operator-blocks","label":"Tangent operator blocks","html_id":"tangent-operator-blocks","implicit":true,"key":"eUgAwc0J6Z"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"By default, the derivatives of the gradients with respect to the fluxes\nare declared. Thus the variable ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"oHmAjmVk2j"},{"type":"inlineCode","value":"∂j∕∂Δ∇T","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"Kr8cZXYCmd"},{"type":"text","value":" is automatically declared.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"NWO97djNQ2"}],"key":"pyf3wt39xd"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"However, as discussed in the next section, the consistent linearisation\nof the thermal equilibrium requires to return the derivate of the heat\nflux with respect to the increment of the temperature (or equivalently\nwith respect to the temperature at the end of the time step).","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"D1q3XLB4MY"}],"key":"IBaet0Au1h"},{"type":"code","lang":"cpp","value":"@AdditionalTangentOperatorBlock ∂j∕∂ΔT;","position":{"start":{"line":121,"column":1},"end":{"line":123,"column":1}},"key":"jLu0COeROQ"},{"type":"heading","depth":3,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Parameters","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"NgtuqBUm2A"}],"identifier":"parameters","label":"Parameters","html_id":"parameters","implicit":true,"key":"nd5KyKPXfZ"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"XarJLVvlEp"},{"type":"inlineCode","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"bOQxSxK7yd"},{"type":"text","value":" and ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"BciCXh3HkK"},{"type":"inlineCode","value":"B","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"bCAeIUbUNn"},{"type":"text","value":" coefficients that appears in the definition of the\nthermal conductivity are declared as parameters:","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"SJIkkM9lFP"}],"key":"dpHidfXqhN"},{"type":"code","lang":"cpp","value":"@Parameter real A = 0.0375;\n@Parameter real B = 2.165e-4;","position":{"start":{"line":130,"column":1},"end":{"line":133,"column":1}},"key":"CsVmOH8Koz"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Parameters are stored globally and can be modified from the calling\nsolver or from ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"N1EUhqFhvo"},{"type":"inlineCode","value":"python","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"U9pxsOCF6Z"},{"type":"text","value":" in the case of the coupling with ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"EDm0B4jQ1a"},{"type":"inlineCode","value":"FEniCS","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"bg3piVmidc"},{"type":"text","value":"\ndiscussed below.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"vpegl2xaqS"}],"key":"K4HhpdSddm"},{"type":"heading","depth":3,"position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"Local variable","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"ihCgTVWazb"}],"identifier":"local-variable","label":"Local variable","html_id":"local-variable","implicit":true,"key":"IyOpElpwXo"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"A local variable is accessible in each code blocks.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"eBiuzW5ol2"}],"key":"sXjf7SKUh9"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Here, we declare the thermal conductivity ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"JbNBkX6Bl1"},{"type":"inlineCode","value":"k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"sk8n6SLlWQ"},{"type":"text","value":" as a local variable in\norder to be able to compute its value during the behaviour integration\nand to reuse this value when computing the tangent operator.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"y4wKjOferW"}],"key":"qcY56hGxqd"},{"type":"code","lang":"cpp","value":"@LocalVariable thermalconductivity k;","position":{"start":{"line":147,"column":1},"end":{"line":149,"column":1}},"key":"jLWWWN68Zz"},{"type":"heading","depth":3,"position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Integration of the behaviour","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"Wug0mrKKtS"}],"identifier":"integration-of-the-behaviour","label":"Integration of the behaviour","html_id":"integration-of-the-behaviour","implicit":true,"key":"q2HNx2loFO"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"The behaviour integration is straightforward: one starts to compute the\ntemperature at the end of the time step, then we compute the thermal\nconductivity (at the end of the time step) and the heat flux using the\ntemperature gradient (at the end of the time step).","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"DY20RyOVhr"}],"key":"xJkDhETXCk"},{"type":"code","lang":"cpp","value":"@Integrator{\n  // temperature at the end of the time step\n  const auto T_ = T + ΔT;\n  // thermal conductivity\n  k = 1 / (A + B ⋅ T_);\n  // heat flux\n  j = -k ⋅ (∇T + Δ∇T);\n} // end of @Integrator","position":{"start":{"line":158,"column":1},"end":{"line":167,"column":1}},"key":"kHsfeev6el"},{"type":"heading","depth":3,"position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Tangent operator","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"wEQrV8A49J"}],"identifier":"tangent-operator","label":"Tangent operator","html_id":"tangent-operator","implicit":true,"key":"JWYLawBgw8"},{"type":"paragraph","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"The computation of the tangent operator blocks is equally simple:","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"ROcNnolAfu"}],"key":"qfCzBenANY"},{"type":"code","lang":"cpp","value":"@TangentOperator {\n  ∂j∕∂Δ∇T = -k ⋅ tmatrix<N, N, real>::Id();\n  ∂j∕∂ΔT  =  B ⋅ k ⋅ k ⋅ (∇T + Δ∇T);\n} // end of @TangentOperator ","position":{"start":{"line":173,"column":1},"end":{"line":178,"column":1}},"key":"lAHLmqAADq"},{"type":"heading","depth":2,"position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"inlineCode","value":"FEniCSx","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"e8BerWtUO2"},{"type":"text","value":" implementation","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"y1RjPjwbjo"}],"identifier":"fenicsx-implementation","label":"FEniCSx implementation","html_id":"fenicsx-implementation","implicit":true,"key":"BhU6R5yzJz"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"We consider a rectanglar domain with imposed temperatures ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"x3QwAy808O"},{"type":"inlineCode","value":"Tl","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ouBW0dInw6"},{"type":"text","value":" (resp. ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZpbAYKToNT"},{"type":"inlineCode","value":"Tr","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZAxnWi3XsH"},{"type":"text","value":") on the left (resp. right) boundaries. We want to solve for the temperature field ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"P87tContUe"},{"type":"inlineCode","value":"T","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"xapobwEG5S"},{"type":"text","value":" inside the domain using a ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"nFKdtrXVUc"},{"type":"inlineMath","value":"P^1","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>P</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">P^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span>","key":"m83nNLxhMi"},{"type":"text","value":"-interpolation. We initialize the temperature at value ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Gqu04mvGiE"},{"type":"inlineCode","value":"Tl","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"rzkp6frdK6"},{"type":"text","value":" throughout the domain.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"DfFw9Md4Np"}],"key":"oGTkYRLmVJ"}],"key":"sn0CLzfEgY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport ufl\nfrom mpi4py import MPI\nfrom dolfinx import fem, mesh\nfrom dolfinx.cpp.nls.petsc import NewtonSolver\nfrom dolfinx_materials.quadrature_map import QuadratureMap\nfrom dolfinx_materials.solvers import NonlinearMaterialProblem\nfrom dolfinx_materials.material.mfront import MFrontMaterial\nimport os\n\n\ncurrent_path = os.getcwd()\n\nlength = 30e-3\nwidth = 5.4e-3\ndomain = mesh.create_rectangle(MPI.COMM_WORLD, [(0.0, 0.0), (length, width)], [100, 10])\n\nV = fem.functionspace(domain, (\"CG\", 1))\nT = fem.Function(V, name=\"Temperature\")\n\n\ndef left(x):\n    return np.isclose(x[0], 0)\n\n\ndef right(x):\n    return np.isclose(x[0], length)\n\n\nTl = 300.0\nTr = 800.0\nT.x.petsc_vec.set(Tl)\n\nleft_dofs = fem.locate_dofs_geometrical(V, left)\nright_dofs = fem.locate_dofs_geometrical(V, right)\n\nbcs = [fem.dirichletbc(Tl, left_dofs, V), fem.dirichletbc(Tr, right_dofs, V)]","key":"VjRivrd6ym"},{"type":"output","id":"DFw-OrKDv8A_lp3qnhQcd","data":[],"key":"KpaktM8AmP"}],"key":"ypnQ05cmQX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading the material behaviour","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TE8SELgu1F"}],"identifier":"loading-the-material-behaviour","label":"Loading the material behaviour","html_id":"loading-the-material-behaviour","implicit":true,"key":"NmQQ2PByuV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kRhkuNkE5o"},{"type":"inlineCode","value":"MFrontMaterial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mE3x4KA35E"},{"type":"text","value":" class for describing the material behaviour. The first argument corresponds to the path where material librairies have been compiled, the second correspond to the name of the behaviour (declared with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SwqKLTNCck"},{"type":"inlineCode","value":"@Behaviour","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V2nd2TICyl"},{"type":"text","value":"). Finally, the modelling hypothesis is specified (default behaviour is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wygQORn4aW"},{"type":"inlineCode","value":"\"3d\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wvbqd9OHsi"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yWvWqjPtRr"}],"key":"ZdbcS77Myf"}],"key":"KcoooufFuf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"material = MFrontMaterial(\n    os.path.join(current_path, \"src/libBehaviour.so\"),\n    \"StationaryHeatTransfer\",\n    hypothesis=\"plane_strain\",\n)","key":"vQgaeaAwLS"},{"type":"output","id":"zL03zeGuI5sz_6LM17qhq","data":[],"key":"XLkQgpa7Hq"}],"key":"sufTZqcD9x"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zVPAgEifYv"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NoFq2cRtyL"},{"type":"text","value":" behaviour declares the field ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m6fEoCJJeI"},{"type":"inlineCode","value":"\"TemperatureGradient\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AvsailRtZl"},{"type":"text","value":" as a Gradient variable, with its associated Flux called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hjZWMWskg5"},{"type":"inlineCode","value":"\"HeatFlux\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TamlZmAvTM"},{"type":"text","value":". We can check that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iXNHV5zGPF"},{"type":"inlineCode","value":"material","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ch4XMqBoFm"},{"type":"text","value":" object retrieves ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RUkci02Imv"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a1CQIBXufo"},{"type":"text","value":"’s gradient and flux names, as well as the different tangent operator blocks which have been defined, namely ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kjw9rOQ87F"},{"type":"inlineCode","value":"dj_ddgT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H7u7ZYCdwe"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJlT2KbVDi"},{"type":"inlineCode","value":"dj_ddT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q8TtHItZT1"},{"type":"text","value":" in the present case:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"batDxorSOQ"}],"key":"ZffCUKuO7n"}],"key":"MEvgDhxvjv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(material.gradients)\nprint(material.fluxes)\n\nprint([\"d{}_d{}\".format(*t) for t in material.tangent_blocks])","key":"XuolBVHe7L"},{"type":"output","id":"2BwqU4aJOF71BIPoF5uwR","data":[],"key":"hl5R33K04P"}],"key":"AocoAqrM3S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Non-linear problem definition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QDgupQ7Hg7"}],"identifier":"non-linear-problem-definition","label":"Non-linear problem definition","html_id":"non-linear-problem-definition","implicit":true,"key":"QXX4YOhC6G"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We now define the non-linear residual form that we want to solve. After defining test and trial functions, we instantiate the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GfJYS0uksu"},{"type":"inlineCode","value":"QuadratureMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ozHCoAuXbw"},{"type":"text","value":" object which will handle the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LsmRMlchsw"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"black-box","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NJyI66Eilh"}],"key":"Xl8zuVdlLi"},{"type":"text","value":" constitutive equation based on the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d99kh67BNt"},{"type":"inlineCode","value":"material","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N6xxdRC14b"},{"type":"text","value":" object. We must provide the requested quadrature degree which will control the number of quadrature points used in each cell to compute the non-linear constitutive law. Here, we specify a quadrature of degree 2 (i.e. 3 Gauss points for a triangular element).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fC3dqVUvH7"}],"key":"W36xZp5siK"}],"key":"RCvxDLGobR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"T_ = ufl.TestFunction(V)\ndT = ufl.TrialFunction(V)\n\ndeg_quad = 2\nqmap = QuadratureMap(domain, deg_quad, material)","key":"sl44UawZZw"},{"type":"output","id":"a_hWODiqcxalCZyj0LcJ2","data":[],"key":"VlLMTlwIOP"}],"key":"ncr0cXRzVp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Variable registration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"APUD4Ga2ZW"}],"identifier":"variable-registration","label":"Variable registration","html_id":"variable-registration","implicit":true,"key":"ug4NxnE7Nw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y8lc95tzF8"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ohFohlJPWZ"},{"type":"text","value":" behaviour implicitly declares the temperature as an external state variable called ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gCDDttdTgv"},{"type":"inlineCode","value":"\"Temperature\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ODI7egapXa"},{"type":"text","value":". We must therefore associate this external state variable to a known mechanical field. This can be achieved explicitly using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NX5xoeAbhT"},{"type":"inlineCode","value":"register_external_state_variable","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W7QubspAH1"},{"type":"text","value":" method.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ued0DA8pQh"}],"key":"ARdrIGpUhQ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For problems in which the temperature only acts as a parameter (no jacobian blocks with respect to the temperature), the temperature can be automatically registered as a constant value (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WJHJFi77EU"},{"type":"inlineMath","value":"293.15 \\text{ K}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>293.15</mn><mtext> K</mtext></mrow><annotation encoding=\"application/x-tex\">293.15 \\text{ K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">293.15</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span></span>","key":"x4Re0jQ7R0"},{"type":"text","value":" by default) or to any other (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TSzQGxv4Yj"},{"type":"inlineCode","value":"dolfin.Constant","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Rhk927ZwqP"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BGcXS3B63S"},{"type":"inlineCode","value":"float","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WjC8Rp600S"},{"type":"text","value":" or ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B6FqS4VZDl"},{"type":"inlineCode","value":"dolfin.Function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hcNlRMx5I3"},{"type":"text","value":") value using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CNpTWv7til"},{"type":"inlineCode","value":"register_external_state_variable","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hHiqiN0Hyf"},{"type":"text","value":" method.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DK1RVwUj2g"}],"key":"L5gKIbPAaB"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Finally, we need to associate to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I1zDQYJ5xw"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"v7b6uZyFQl"},{"type":"text","value":" gradient object the corresponding UFL expression as a function of the unknown field ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PTEPS2KOxb"},{"type":"inlineCode","value":"T","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Zupr72tGB1"},{"type":"text","value":". To do so, we use the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bdD0UDR5Q8"},{"type":"inlineCode","value":"register_gradient","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jwBGeOiiYQ"},{"type":"text","value":" method linking ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AboST7OUzX"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fT60Ja5Noo"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MuR5WnOC8n"},{"type":"inlineCode","value":"\"TemperatureGradient\"","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CGbBRFieLb"},{"type":"text","value":" object to the UFL expression ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mpJwbba6gi"},{"type":"inlineCode","value":"grad(T)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I4adNpPX1T"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UMOqJdQH4z"}],"key":"FZbS7O0JaJ"}],"key":"Cb5i4wy9p3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"qmap.register_external_state_variable(\"Temperature\", T)\nqmap.register_gradient(\"TemperatureGradient\", ufl.grad(T))","key":"wPDdJIxX7a"},{"type":"output","id":"fgnO4I6yTFFIw-zIz-NIq","data":[],"key":"wUqZMKIqRr"}],"key":"iwhc5LdIrx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nonlinear variational formulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HUlBZldVqC"}],"identifier":"nonlinear-variational-formulation","label":"Nonlinear variational formulation","html_id":"nonlinear-variational-formulation","implicit":true,"key":"RasTwZcSJL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are now in position of defining the nonlinear variational formulation corresponding to the stationary nonlinear heat transfer. Without any external loading, the nonlinear residual reads as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kw1yauLbwn"}],"key":"B4sMDnwBWo"},{"type":"math","value":"F(\\widehat{T}) = \\int_\\Omega \\mathbf{j}\\cdot \\nabla \\widehat{T} \\text{dx} = 0 \\quad \\forall \\widehat{T}","enumerated":true,"tight":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>T</mi><mo stretchy=\"true\">^</mo></mover><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>∫</mo><mi mathvariant=\"normal\">Ω</mi></msub><mi mathvariant=\"bold\">j</mi><mo>⋅</mo><mi mathvariant=\"normal\">∇</mi><mover accent=\"true\"><mi>T</mi><mo stretchy=\"true\">^</mo></mover><mtext>dx</mtext><mo>=</mo><mn>0</mn><mspace width=\"1em\"/><mi mathvariant=\"normal\">∀</mi><mover accent=\"true\"><mi>T</mi><mo stretchy=\"true\">^</mo></mover></mrow><annotation encoding=\"application/x-tex\">F(\\widehat{T}) = \\int_\\Omega \\mathbf{j}\\cdot \\nabla \\widehat{T} \\text{dx} = 0 \\quad \\forall \\widehat{T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1733em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9233em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2719em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.4336em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">Ω</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9233em;\"></span><span class=\"mord\">∇</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9233em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\">dx</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9233em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord\">∀</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9233em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"ZrxWTRtuoW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"where the heat flux ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NCurjpqmd4"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span></span></span></span>","key":"lWSaIq3Apr"},{"type":"text","value":" is provided by the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Gf34pUOJEo"},{"type":"inlineCode","value":"QuadratureMap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GIiTHi3eFw"},{"type":"text","value":" as a flux. The latter is a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O3aIUSEMxH"},{"type":"inlineCode","value":"dolfinx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QHPgDbM0tZ"},{"type":"text","value":" function defined on ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uLC3CXGAdX"},{"type":"inlineCode","value":"Quadrature","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KUzqYXqrjc"},{"type":"text","value":" function space (no interpolation is possible). Note that the integration measure must match the chosen quadrature scheme and quadrature degree. It is provided here as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Yvs82sX3iN"},{"type":"inlineCode","value":"qmap.dx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rC9BHYtSRP"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"c61FGl0hRA"}],"key":"G20win8cbz"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uK0oYlP1jZ"},{"type":"inlineCode","value":"qmap.derivative","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VWsJk609Pg"},{"type":"text","value":" function works similarly to the standard ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"d3ML0Fwr0W"},{"type":"inlineCode","value":"ufl.derivative","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jgm08hUEOg"},{"type":"text","value":" function except that it will also differentiate the heat flux. From the two tangent operator blocks ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kzi8iu11Zj"},{"type":"inlineCode","value":"dj_ddgT","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"r1Gx6hqE8e"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SoNio3PnAB"},{"type":"inlineCode","value":"dj_ddT","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GYW93nEUo2"},{"type":"text","value":", it will automatically be deduced that the heat flux ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xdj1MN321A"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span></span></span></span>","key":"P5mna0eAqM"},{"type":"text","value":" is a function of both the temperature gradient ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tcPugIRfI5"},{"type":"inlineMath","value":"\\mathbf{g}=\\nabla T","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo>=</mo><mi mathvariant=\"normal\">∇</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}=\\nabla T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"ktKLrmsy81"},{"type":"text","value":" and the temperature itself i.e. ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CzZHGmgExV"},{"type":"inlineMath","value":"\\mathbf{j}=\\mathbf{j}(\\mathbf{g}, T)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi><mo>=</mo><mi mathvariant=\"bold\">j</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">g</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}=\\mathbf{j}(\\mathbf{g}, T)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">j</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span></span></span></span>","key":"yIYAV9msOk"},{"type":"text","value":". Hence, the computed Jacobian form will be:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lgdm6ygCwo"}],"key":"SqVxgaSaTU"},{"type":"math","value":"J(\\widehat{T},T^*) = \\int_{\\Omega} \\nabla \\widehat{T}\\cdot\\left(\\dfrac{\\partial \\mathbf{j}}{\\partial \\mathbf{g}}\\cdot \\nabla T^*+\\dfrac{\\partial \\mathbf{j}}{\\partial T}\\cdot T^*\\right) \\text{dx}","enumerated":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>J</mi><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>T</mi><mo stretchy=\"true\">^</mo></mover><mo separator=\"true\">,</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>∫</mo><mi mathvariant=\"normal\">Ω</mi></msub><mi mathvariant=\"normal\">∇</mi><mover accent=\"true\"><mi>T</mi><mo stretchy=\"true\">^</mo></mover><mo>⋅</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">g</mi></mrow></mfrac><mo>⋅</mo><mi mathvariant=\"normal\">∇</mi><msup><mi>T</mi><mo>∗</mo></msup><mo>+</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"bold\">j</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>T</mi></mrow></mfrac><mo>⋅</mo><msup><mi>T</mi><mo>∗</mo></msup><mo fence=\"true\">)</mo></mrow><mtext>dx</mtext></mrow><annotation encoding=\"application/x-tex\">J(\\widehat{T},T^*) = \\int_{\\Omega} \\nabla \\widehat{T}\\cdot\\left(\\dfrac{\\partial \\mathbf{j}}{\\partial \\mathbf{g}}\\cdot \\nabla T^*+\\dfrac{\\partial \\mathbf{j}}{\\partial T}\\cdot T^*\\right) \\text{dx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1733em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9233em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2719em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.4336em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Ω</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∇</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9233em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∇</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathbf\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">dx</span></span></span></span></span></span>","enumerator":"6","key":"imsQJzh5Bf"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The resulting nonlinear problem is managed by the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"aLEExDYWLZ"},{"type":"inlineCode","value":"NonlinearMaterialProblem","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rk6EUe6kKP"},{"type":"text","value":" class. It is solved using a Newton non-linear solver. The ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kjCq0S9dOZ"},{"type":"inlineCode","value":"solve","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mjYEcMBGz8"},{"type":"text","value":" method returns the converged status and the number of Newton iterations.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"bjJRQsykSQ"}],"key":"cE25qifAYa"}],"key":"deAv5honBe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"j = qmap.fluxes[\"HeatFlux\"]\n\nF = ufl.dot(j, ufl.grad(T_)) * qmap.dx\nJac = qmap.derivative(F, T, dT)\n\nproblem = NonlinearMaterialProblem(qmap, F, Jac, T, bcs)\n\nnewton = NewtonSolver(MPI.COMM_WORLD)\n\nconverged, it = problem.solve(newton)\n\n# Problem is weakly nonlinear, it should converge in a few iterations\nassert converged and it < 10","key":"gWwLuQPNIr"},{"type":"output","id":"Docf-8s-ctsWMy4zDp-eS","data":[],"key":"qvodTCAa6J"}],"key":"KRF3R3lStr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We finally check that the thermal conductivity coefficient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"okhyxZEYpj"},{"type":"inlineMath","value":"k","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"gMtneN6UaJ"},{"type":"text","value":", computed from the ratio between the horizontal heat flux and temperature gradient matches the temperature-dependent expressions implemented in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TaMrk0zAws"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dJ5TdEQx0V"},{"type":"text","value":" behaviour.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P2d2FqwLGJ"}],"key":"Sm45WzgrqZ"}],"key":"DH9L71ARfk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"j_vals = j.x.array\ng_vals = qmap.gradients[\"TemperatureGradient\"].function.x.array\nk_gauss = -j_vals[::2] / g_vals[::2]\nT_gauss = qmap.external_state_variables[\"Temperature\"].function.x.array\nA = material.get_parameter(\"A\")\nB = material.get_parameter(\"B\")\nk_ref = 1 / (A + B * T_gauss)\nplt.plot(T_gauss, k_gauss, \"o\", label=\"FE\")\nplt.plot(T_gauss, k_ref, \".\", label=\"ref\")\nplt.xlabel(r\"Temperature $T\\: (K)$\")\nplt.ylabel(r\"Thermal conductivity $k\\: (W.m^{-1}.K^{-1})$\")\nplt.legend()\nplt.show()","key":"O054ybIT3B"},{"type":"output","id":"BjnkZig6IvIhaIxwjcAG9","data":[],"key":"VfJPlwqeZS"}],"key":"Ns0tdIZ5o6"}],"key":"lqW2iOomMi"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Introduction","url":"/introduction-2","group":"Demos coupling FEniCSx & MFront"},"next":{"title":"Poroelasticity","url":"/poroelasticity-2","group":"Demos coupling FEniCSx & MFront"}}},"domain":"http://localhost:3000"}