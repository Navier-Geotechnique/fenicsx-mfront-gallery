<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Stationary nonlinear heat transfer - FEniCSx &amp; MFront Gallery</title><meta property="og:title" content="Stationary nonlinear heat transfer - FEniCSx &amp; MFront Gallery"/><meta name="generator" content="mystmd"/><meta name="description" content="A gallery of projects with MFront and FEniCSx for coupled geomechanics problems"/><meta property="og:description" content="A gallery of projects with MFront and FEniCSx for coupled geomechanics problems"/><meta name="keywords" content=""/><link rel="stylesheet" href="/fenicsx-mfront-gallery/build/_assets/app-IZWEOBHI.css"/><link rel="stylesheet" href="/fenicsx-mfront-gallery/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/fenicsx-mfront-gallery/favicon.ico"/><link rel="stylesheet" href="/fenicsx-mfront-gallery/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/fenicsx-mfront-gallery/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/fenicsx-mfront-gallery/build/site_logo-62ee2db71d5818ec3e5741b65aff895d.png" class="h-9" alt="FEniCSx &amp; MFront Gallery" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="FEniCSx &amp; MFront Gallery" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/fenicsx-mfront-gallery/">FEniCSx &amp; MFront Gallery</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Implementing material behaviors with MFront" class="block break-words rounded py-2 grow cursor-pointer">Implementing material behaviors with MFront</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Finite Element Analysis with FEniCSx" class="block break-words rounded py-2 grow cursor-pointer">Finite Element Analysis with FEniCSx</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Demos coupling FEniCSx &amp; MFront" class="block break-words rounded py-2 grow cursor-pointer">Demos coupling FEniCSx &amp; MFront</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery" title="GitHub Repository: Navier-Geotechnique/fenicsx-mfront-gallery" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery/edit/main/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Stationary nonlinear heat transfer</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="sn0CLzfEgY" class="relative group/block"><p>This demo shows how to use a simple <code>MFront</code> behaviour to solve a non-linear sationary heat transfer equation with <code>dolfinx_materials</code>.</p><h2 id="description-of-the-non-linear-constitutive-heat-transfer-law" class="relative group"><span class="heading-text">Description of the non-linear constitutive heat transfer law</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#description-of-the-non-linear-constitutive-heat-transfer-law" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The thermal material is described by the following non linear Fourier
Law:</p><div id="XHC9HnKjyW" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">j</mi><mo>=</mo><mo>−</mo><mi>k</mi><mrow><mo fence="true">(</mo><mi>T</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mi mathvariant="bold">∇</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}=-k\left(T\right)\,\mathbf{\nabla} T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#XHC9HnKjyW" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> is the heat flux and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">∇</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\mathbf{\nabla} T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> is the
temperature gradient.</p><h3 id="expression-of-the-thermal-conductivity" class="relative group"><span class="heading-text">Expression of the thermal conductivity</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#expression-of-the-thermal-conductivity" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The thermal conductivity is assumed to be given by:</p><div id="OJTSyzB6CE" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>k</mi><mrow><mo fence="true">(</mo><mi>T</mi><mo fence="true">)</mo></mrow><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mn>1</mn></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi>A</mi><mo>+</mo><mi>B</mi><mtext> </mtext><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding="application/x-tex">k\left(T\right)={\displaystyle \frac{\displaystyle 1}{\displaystyle A+B\,T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#OJTSyzB6CE" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>This expression accounts for the phononic contribution to the thermal
conductivity.</p><h3 id="derivatives" class="relative group"><span class="heading-text">Derivatives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#derivatives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>As discussed below, the consistent linearisation of the heat transfer
equilibrium requires to compute:</p><ul><li><p>the derivative
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">∇</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial \mathbf{\nabla} T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
of the heat flux with respect to the temperature gradient.
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">∇</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial \mathbf{\nabla} T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
is given by: </p><div id="Fi9MyFnVwL" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">∇</mi><mi>T</mi></mstyle></mfrac></mstyle><mo>=</mo><mo>−</mo><mi>k</mi><mrow><mo fence="true">(</mo><mi>T</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mi>I</mi></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial \mathbf{\nabla} T}}=-k\left(T\right)\,I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#Fi9MyFnVwL" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div></li><li><p>the derivative
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
of the heat flux with respect to the temperature.
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi>T</mi></mstyle></mfrac></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
is given by: </p><div id="YGEbXd23lA" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi>T</mi></mstyle></mfrac></mstyle><mo>=</mo><mo>−</mo><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi>k</mi><mrow><mo fence="true">(</mo><mi>T</mi><mo fence="true">)</mo></mrow></mstyle><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">∂</mi><mi>T</mi></mstyle></mfrac></mstyle><mtext> </mtext><mi mathvariant="bold">∇</mi><mi>T</mi><mo>=</mo><mi>B</mi><mtext> </mtext><msup><mi>k</mi><mn>2</mn></msup><mtext> </mtext><mi mathvariant="bold">∇</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">{\displaystyle \frac{\displaystyle \partial \mathbf{j}}{\displaystyle \partial T}}=-{\displaystyle \frac{\displaystyle \partial k\left(T\right)}{\displaystyle \partial T}}\,\mathbf{\nabla} T=B\,k^{2}\,\mathbf{\nabla} T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#YGEbXd23lA" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div></li></ul><h2 id="mfront-implementation" class="relative group"><span class="heading-text"><code>MFront</code> implementation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#mfront-implementation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="choice-of-the-the-domain-specific-language" class="relative group"><span class="heading-text">Choice of the the domain specific language</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#choice-of-the-the-domain-specific-language" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Every <code>MFront</code> file is handled by a domain specific language (DSL), which
aims at providing the most suitable abstraction for a particular choice
of behaviour and integration algorithm. See <code>mfront mfront --list-dsl</code>
for a list of the available DSLs.</p><p>The name of DSL’s handling generic behaviours ends with
<code>GenericBehaviour</code>. The first part of a DSL’s name is related to the
integration algorithm used.</p><p>In the case of this non linear transfer behaviour, the heat flux is
explicitly computed from the temperature and the temperature gradient.
The <code>DefaultGenericBehaviour</code> is the most suitable choice:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@DSL DefaultGenericBehaviour;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="some-metadata" class="relative group"><span class="heading-text">Some metadata</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#some-metadata" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The following lines define the name of the behaviour, the name of the
author and the date of its writing:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@Behaviour StationaryHeatTransfer;
@Author Thomas Helfer;
@Date 15/02/2019;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="gradients-and-fluxes" class="relative group"><span class="heading-text">Gradients and fluxes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#gradients-and-fluxes" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Generic behaviours relate pairs of gradients and fluxes. Gradients and
fluxes are declared independently but the first declared gradient is
assumed to be conjugated with the first declared fluxes and so on…</p><p>The temperature gradient is declared as follows (note that Unicode characters are supported):</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@Gradient TemperatureGradient ∇T;
∇T.setGlossaryName(&quot;TemperatureGradient&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Note that we associated to <code>∇T</code> the glossary name <code>TemperatureGradient</code>.
This is helpful for the calling code.</p><p>After this declaration, the following variables will be defined:</p><ul><li><p>The temperature gradient <code>∇T</code> at the beginning of the time step.</p></li><li><p>The increment of the temperature gradient <code>Δ∇T</code> over the time step.</p></li></ul><p>The heat flux is then declared as follows:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@Flux HeatFlux j;
j.setGlossaryName(&quot;HeatFlux&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>In the following code blocks, <code>j</code> will be the heat flux at the end of
the time step.</p><h3 id="tangent-operator-blocks" class="relative group"><span class="heading-text">Tangent operator blocks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#tangent-operator-blocks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>By default, the derivatives of the gradients with respect to the fluxes
are declared. Thus the variable <code>∂j∕∂Δ∇T</code> is automatically declared.</p><p>However, as discussed in the next section, the consistent linearisation
of the thermal equilibrium requires to return the derivate of the heat
flux with respect to the increment of the temperature (or equivalently
with respect to the temperature at the end of the time step).</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@AdditionalTangentOperatorBlock ∂j∕∂ΔT;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="parameters" class="relative group"><span class="heading-text">Parameters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The <code>A</code> and <code>B</code> coefficients that appears in the definition of the
thermal conductivity are declared as parameters:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@Parameter real A = 0.0375;
@Parameter real B = 2.165e-4;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Parameters are stored globally and can be modified from the calling
solver or from <code>python</code> in the case of the coupling with <code>FEniCS</code>
discussed below.</p><h3 id="local-variable" class="relative group"><span class="heading-text">Local variable</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#local-variable" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>A local variable is accessible in each code blocks.</p><p>Here, we declare the thermal conductivity <code>k</code> as a local variable in
order to be able to compute its value during the behaviour integration
and to reuse this value when computing the tangent operator.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@LocalVariable thermalconductivity k;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="integration-of-the-behaviour" class="relative group"><span class="heading-text">Integration of the behaviour</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#integration-of-the-behaviour" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The behaviour integration is straightforward: one starts to compute the
temperature at the end of the time step, then we compute the thermal
conductivity (at the end of the time step) and the heat flux using the
temperature gradient (at the end of the time step).</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@Integrator{
  // temperature at the end of the time step
  const auto T_ = T + ΔT;
  // thermal conductivity
  k = 1 / (A + B ⋅ T_);
  // heat flux
  j = -k ⋅ (∇T + Δ∇T);
} // end of @Integrator</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="tangent-operator" class="relative group"><span class="heading-text">Tangent operator</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#tangent-operator" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The computation of the tangent operator blocks is equally simple:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-cpp" style="white-space:pre">@TangentOperator {
  ∂j∕∂Δ∇T = -k ⋅ tmatrix&lt;N, N, real&gt;::Id();
  ∂j∕∂ΔT  =  B ⋅ k ⋅ k ⋅ (∇T + Δ∇T);
} // end of @TangentOperator </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="fenicsx-implementation" class="relative group"><span class="heading-text"><code>FEniCSx</code> implementation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fenicsx-implementation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We consider a rectanglar domain with imposed temperatures <code>Tl</code> (resp. <code>Tr</code>) on the left (resp. right) boundaries. We want to solve for the temperature field <code>T</code> inside the domain using a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>P</mi><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">P^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>-interpolation. We initialize the temperature at value <code>Tl</code> throughout the domain.</p></div><div id="ypnQ05cmQX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
import ufl
from mpi4py import MPI
from dolfinx import fem, mesh
from dolfinx.cpp.nls.petsc import NewtonSolver
from dolfinx_materials.quadrature_map import QuadratureMap
from dolfinx_materials.solvers import NonlinearMaterialProblem
from dolfinx_materials.material.mfront import MFrontMaterial
import os


current_path = os.getcwd()

length = 30e-3
width = 5.4e-3
domain = mesh.create_rectangle(MPI.COMM_WORLD, [(0.0, 0.0), (length, width)], [100, 10])

V = fem.functionspace(domain, (&quot;CG&quot;, 1))
T = fem.Function(V, name=&quot;Temperature&quot;)


def left(x):
    return np.isclose(x[0], 0)


def right(x):
    return np.isclose(x[0], length)


Tl = 300.0
Tr = 800.0
T.x.petsc_vec.set(Tl)

left_dofs = fem.locate_dofs_geometrical(V, left)
right_dofs = fem.locate_dofs_geometrical(V, right)

bcs = [fem.dirichletbc(Tl, left_dofs, V), fem.dirichletbc(Tr, right_dofs, V)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DFw-OrKDv8A_lp3qnhQcd" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="KcoooufFuf" class="relative group/block"><h3 id="loading-the-material-behaviour" class="relative group"><span class="heading-text">Loading the material behaviour</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#loading-the-material-behaviour" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We use the <code>MFrontMaterial</code> class for describing the material behaviour. The first argument corresponds to the path where material librairies have been compiled, the second correspond to the name of the behaviour (declared with <code>@Behaviour</code>). Finally, the modelling hypothesis is specified (default behaviour is <code>&quot;3d&quot;</code>).</p></div><div id="sufTZqcD9x" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">material = MFrontMaterial(
    os.path.join(current_path, &quot;src/libBehaviour.so&quot;),
    &quot;StationaryHeatTransfer&quot;,
    hypothesis=&quot;plane_strain&quot;,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zL03zeGuI5sz_6LM17qhq" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="MEvgDhxvjv" class="relative group/block"><p>The <code>MFront</code> behaviour declares the field <code>&quot;TemperatureGradient&quot;</code> as a Gradient variable, with its associated Flux called <code>&quot;HeatFlux&quot;</code>. We can check that the <code>material</code> object retrieves <code>MFront</code>’s gradient and flux names, as well as the different tangent operator blocks which have been defined, namely <code>dj_ddgT</code> and <code>dj_ddT</code> in the present case:</p></div><div id="AocoAqrM3S" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(material.gradients)
print(material.fluxes)

print([&quot;d{}_d{}&quot;.format(*t) for t in material.tangent_blocks])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2BwqU4aJOF71BIPoF5uwR" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="RCvxDLGobR" class="relative group/block"><h3 id="non-linear-problem-definition" class="relative group"><span class="heading-text">Non-linear problem definition</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#non-linear-problem-definition" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We now define the non-linear residual form that we want to solve. After defining test and trial functions, we instantiate the <code>QuadratureMap</code> object which will handle the <em>black-box</em> constitutive equation based on the <code>material</code> object. We must provide the requested quadrature degree which will control the number of quadrature points used in each cell to compute the non-linear constitutive law. Here, we specify a quadrature of degree 2 (i.e. 3 Gauss points for a triangular element).</p></div><div id="ncr0cXRzVp" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">T_ = ufl.TestFunction(V)
dT = ufl.TrialFunction(V)

deg_quad = 2
qmap = QuadratureMap(domain, deg_quad, material)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="a_hWODiqcxalCZyj0LcJ2" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="Cb5i4wy9p3" class="relative group/block"><h4 id="variable-registration" class="relative group"><span class="heading-text">Variable registration</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#variable-registration" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>The <code>MFront</code> behaviour implicitly declares the temperature as an external state variable called <code>&quot;Temperature&quot;</code>. We must therefore associate this external state variable to a known mechanical field. This can be achieved explicitly using the <code>register_external_state_variable</code> method.</p><p>For problems in which the temperature only acts as a parameter (no jacobian blocks with respect to the temperature), the temperature can be automatically registered as a constant value (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>293.15</mn><mtext> K</mtext></mrow><annotation encoding="application/x-tex">293.15 \text{ K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">293.15</span><span class="mord text"><span class="mord"> K</span></span></span></span></span></span> by default) or to any other (<code>dolfin.Constant</code>, <code>float</code> or <code>dolfin.Function</code>) value using the <code>register_external_state_variable</code> method.</p><p>Finally, we need to associate to <code>MFront</code> gradient object the corresponding UFL expression as a function of the unknown field <code>T</code>. To do so, we use the <code>register_gradient</code> method linking <code>MFront</code> <code>&quot;TemperatureGradient&quot;</code> object to the UFL expression <code>grad(T)</code>.</p></div><div id="iwhc5LdIrx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">qmap.register_external_state_variable(&quot;Temperature&quot;, T)
qmap.register_gradient(&quot;TemperatureGradient&quot;, ufl.grad(T))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fgnO4I6yTFFIw-zIz-NIq" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="deAv5honBe" class="relative group/block"><h4 id="nonlinear-variational-formulation" class="relative group"><span class="heading-text">Nonlinear variational formulation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#nonlinear-variational-formulation" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>We are now in position of defining the nonlinear variational formulation corresponding to the stationary nonlinear heat transfer. Without any external loading, the nonlinear residual reads as:</p><div id="ZrxWTRtuoW" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mover accent="true"><mi>T</mi><mo stretchy="true">^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi mathvariant="bold">j</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mover accent="true"><mi>T</mi><mo stretchy="true">^</mo></mover><mtext>dx</mtext><mo>=</mo><mn>0</mn><mspace width="1em"/><mi mathvariant="normal">∀</mi><mover accent="true"><mi>T</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">F(\widehat{T}) = \int_\Omega \mathbf{j}\cdot \nabla \widehat{T} \text{dx} = 0 \quad \forall \widehat{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1733em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2719em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4336em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9233em;"></span><span class="mord">∇</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class="mord text"><span class="mord">dx</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9233em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#ZrxWTRtuoW" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div><p>where the heat flux <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> is provided by the <code>QuadratureMap</code> as a flux. The latter is a <code>dolfinx</code> function defined on <code>Quadrature</code> function space (no interpolation is possible). Note that the integration measure must match the chosen quadrature scheme and quadrature degree. It is provided here as <code>qmap.dx</code>.</p><p>The <code>qmap.derivative</code> function works similarly to the standard <code>ufl.derivative</code> function except that it will also differentiate the heat flux. From the two tangent operator blocks <code>dj_ddgT</code> and <code>dj_ddT</code>, it will automatically be deduced that the heat flux <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> is a function of both the temperature gradient <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">g</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\mathbf{g}=\nabla T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> and the temperature itself i.e. <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi><mo>=</mo><mi mathvariant="bold">j</mi><mo stretchy="false">(</mo><mi mathvariant="bold">g</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{j}=\mathbf{j}(\mathbf{g}, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">j</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></span>. Hence, the computed Jacobian form will be:</p><div id="imsQJzh5Bf" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mover accent="true"><mi>T</mi><mo stretchy="true">^</mo></mover><mo separator="true">,</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi mathvariant="normal">∇</mi><mover accent="true"><mi>T</mi><mo stretchy="true">^</mo></mover><mo>⋅</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">g</mi></mrow></mfrac><mo>⋅</mo><mi mathvariant="normal">∇</mi><msup><mi>T</mi><mo>∗</mo></msup><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="bold">j</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac><mo>⋅</mo><msup><mi>T</mi><mo>∗</mo></msup><mo fence="true">)</mo></mrow><mtext>dx</mtext></mrow><annotation encoding="application/x-tex">J(\widehat{T},T^*) = \int_{\Omega} \nabla \widehat{T}\cdot\left(\dfrac{\partial \mathbf{j}}{\partial \mathbf{g}}\cdot \nabla T^*+\dfrac{\partial \mathbf{j}}{\partial T}\cdot T^*\right) \text{dx}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1733em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2719em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4336em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Ω</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathbf">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">dx</span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#imsQJzh5Bf" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->6<!-- -->)</a></div></div><p>The resulting nonlinear problem is managed by the <code>NonlinearMaterialProblem</code> class. It is solved using a Newton non-linear solver. The <code>solve</code> method returns the converged status and the number of Newton iterations.</p></div><div id="KRF3R3lStr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">j = qmap.fluxes[&quot;HeatFlux&quot;]

F = ufl.dot(j, ufl.grad(T_)) * qmap.dx
Jac = qmap.derivative(F, T, dT)

problem = NonlinearMaterialProblem(qmap, F, Jac, T, bcs)

newton = NewtonSolver(MPI.COMM_WORLD)

converged, it = problem.solve(newton)

# Problem is weakly nonlinear, it should converge in a few iterations
assert converged and it &lt; 10</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Docf-8s-ctsWMy4zDp-eS" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="DH9L71ARfk" class="relative group/block"><p>We finally check that the thermal conductivity coefficient <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>, computed from the ratio between the horizontal heat flux and temperature gradient matches the temperature-dependent expressions implemented in the <code>MFront</code> behaviour.</p></div><div id="Ns0tdIZ5o6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">j_vals = j.x.array
g_vals = qmap.gradients[&quot;TemperatureGradient&quot;].function.x.array
k_gauss = -j_vals[::2] / g_vals[::2]
T_gauss = qmap.external_state_variables[&quot;Temperature&quot;].function.x.array
A = material.get_parameter(&quot;A&quot;)
B = material.get_parameter(&quot;B&quot;)
k_ref = 1 / (A + B * T_gauss)
plt.plot(T_gauss, k_gauss, &quot;o&quot;, label=&quot;FE&quot;)
plt.plot(T_gauss, k_ref, &quot;.&quot;, label=&quot;ref&quot;)
plt.xlabel(r&quot;Temperature $T\: (K)$&quot;)
plt.ylabel(r&quot;Thermal conductivity $k\: (W.m^{-1}.K^{-1})$&quot;)
plt.legend()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BjnkZig6IvIhaIxwjcAG9" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fenicsx-mfront-gallery/introduction-2"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Demos coupling FEniCSx &amp; MFront</div>Introduction</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/fenicsx-mfront-gallery/poroelasticity-2"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Demos coupling FEniCSx &amp; MFront</div>Poroelasticity</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-F7G67JTZ.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/root-7TUVC4ZT.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/_shared/chunk-INOWNUZ6.js"/><link rel="modulepreload" href="/fenicsx-mfront-gallery/build/routes/$-P6PGXPYX.js"/><script>window.__remixContext = {"url":"/nonlinear-heat-transfer","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","title":"FEniCSx \u0026 MFront Gallery","options":{"favicon":"/fenicsx-mfront-gallery/build/favicon-d0ff10396c68461014b1af5122a96fd5.ico","logo":"/fenicsx-mfront-gallery/build/site_logo-62ee2db71d5818ec3e5741b65aff895d.png"},"nav":[],"actions":[],"projects":[{"math":{"\\tens":{"macro":"\\underline{\\underline{#1}}"}},"title":"FEniCSx \u0026 MFront Gallery","description":"A gallery of projects with MFront and FEniCSx for coupled geomechanics problems","github":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery","id":"4ecd091f-e698-428a-bac0-748b59b665a4","toc":[{"file":"home.md"},{"children":[{"file":"MFront/introduction.md"},{"file":"MFront/Elasticity.ipynb"},{"file":"MFront/poroelasticity.ipynb"},{"file":"MFront/poroplasticity.ipynb"}],"title":"Implementing material behaviors with MFront"},{"children":[{"file":"FEniCSx/introduction.md"},{"file":"FEniCSx/poisson.ipynb"},{"file":"FEniCSx/poroelasticity.ipynb"},{"children":[{"file":"FEniCSx/mixed_formulations.ipynb"},{"file":"FEniCSx/mixed_formulations_2.ipynb"}],"title":"Mixed Formulations"}],"title":"Finite Element Analysis with FEniCSx"},{"children":[{"file":"FEniCSx_Mfront/introduction.md"},{"file":"FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb"},{"file":"FEniCSx_Mfront/2_Poroelasticity/poroelasticity.ipynb"}],"title":"Demos coupling FEniCSx \u0026 MFront"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Implementing material behaviors with MFront"},{"slug":"introduction","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"elasticity","title":"A simple elastic behaviour","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity","title":"Poroelasticity: introduction to multiphysics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroplasticity","title":"Poroplasticity with the Cam-Clay model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Finite Element Analysis with FEniCSx"},{"slug":"introduction-1","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poisson","title":"Variational formulations: the Poisson equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-1","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Mixed Formulations"},{"slug":"mixed-formulations","title":"Why mixed formulations ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"mixed-formulations-2","title":"Implementation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Demos coupling FEniCSx \u0026 MFront"},{"slug":"introduction-2","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-heat-transfer","title":"Stationary nonlinear heat transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-2","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/fenicsx-mfront-gallery"},"routes/$":{"config":{"version":2,"myst":"1.6.4","title":"FEniCSx \u0026 MFront Gallery","options":{"favicon":"/fenicsx-mfront-gallery/build/favicon-d0ff10396c68461014b1af5122a96fd5.ico","logo":"/fenicsx-mfront-gallery/build/site_logo-62ee2db71d5818ec3e5741b65aff895d.png"},"nav":[],"actions":[],"projects":[{"math":{"\\tens":{"macro":"\\underline{\\underline{#1}}"}},"title":"FEniCSx \u0026 MFront Gallery","description":"A gallery of projects with MFront and FEniCSx for coupled geomechanics problems","github":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery","id":"4ecd091f-e698-428a-bac0-748b59b665a4","toc":[{"file":"home.md"},{"children":[{"file":"MFront/introduction.md"},{"file":"MFront/Elasticity.ipynb"},{"file":"MFront/poroelasticity.ipynb"},{"file":"MFront/poroplasticity.ipynb"}],"title":"Implementing material behaviors with MFront"},{"children":[{"file":"FEniCSx/introduction.md"},{"file":"FEniCSx/poisson.ipynb"},{"file":"FEniCSx/poroelasticity.ipynb"},{"children":[{"file":"FEniCSx/mixed_formulations.ipynb"},{"file":"FEniCSx/mixed_formulations_2.ipynb"}],"title":"Mixed Formulations"}],"title":"Finite Element Analysis with FEniCSx"},{"children":[{"file":"FEniCSx_Mfront/introduction.md"},{"file":"FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb"},{"file":"FEniCSx_Mfront/2_Poroelasticity/poroelasticity.ipynb"}],"title":"Demos coupling FEniCSx \u0026 MFront"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Implementing material behaviors with MFront"},{"slug":"introduction","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"elasticity","title":"A simple elastic behaviour","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity","title":"Poroelasticity: introduction to multiphysics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroplasticity","title":"Poroplasticity with the Cam-Clay model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Finite Element Analysis with FEniCSx"},{"slug":"introduction-1","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poisson","title":"Variational formulations: the Poisson equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-1","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Mixed Formulations"},{"slug":"mixed-formulations","title":"Why mixed formulations ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"mixed-formulations-2","title":"Implementation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Demos coupling FEniCSx \u0026 MFront"},{"slug":"introduction-2","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-heat-transfer","title":"Stationary nonlinear heat transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-2","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"cdef4afe59bffabf53564ebda71bd8aeaf268badc48df938b54bba8af2192613","slug":"nonlinear-heat-transfer","location":"/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","dependencies":[],"frontmatter":{"title":"Stationary nonlinear heat transfer","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery","math":{"\\tens":{"macro":"\\underline{\\underline{#1}}"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery/blob/main/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","edit_url":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery/edit/main/FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb","exports":[{"format":"ipynb","filename":"nonlinear_heat_transfer.ipynb","url":"/fenicsx-mfront-gallery/build/nonlinear_heat_trans-5302cd136755395095281a79d1606d22.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This demo shows how to use a simple ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dTD5SpPuzW"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OJfeYzi3V6"},{"type":"text","value":" behaviour to solve a non-linear sationary heat transfer equation with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IvG46UB6fU"},{"type":"inlineCode","value":"dolfinx_materials","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VJiwRJjJLg"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xRjUwAjOxL"}],"key":"rUiBVD1Xr4"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Description of the non-linear constitutive heat transfer law","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TVz7MVafms"}],"identifier":"description-of-the-non-linear-constitutive-heat-transfer-law","label":"Description of the non-linear constitutive heat transfer law","html_id":"description-of-the-non-linear-constitutive-heat-transfer-law","implicit":true,"key":"fcYKhFRx4g"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The thermal material is described by the following non linear Fourier\nLaw:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pmkHPDUcQu"}],"key":"dNpIuG3hVN"},{"type":"math","value":"\\mathbf{j}=-k\\left(T\\right)\\,\\mathbf{\\nabla} T","position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}=-k\\left(T\\right)\\,\\mathbf{\\nabla} T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"XHC9HnKjyW"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vfYSdYvkQj"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"J4sydupEcy"},{"type":"text","value":" is the heat flux and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"YZGDraMeys"},{"type":"inlineMath","value":"\\mathbf{\\nabla} T","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{\\nabla} T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lNy10tX1Oo"},{"type":"text","value":" is the\ntemperature gradient.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jzRg4UQN7q"}],"key":"lusjT1C0li"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Expression of the thermal conductivity","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ZW8S1TkT3n"}],"identifier":"expression-of-the-thermal-conductivity","label":"Expression of the thermal conductivity","html_id":"expression-of-the-thermal-conductivity","implicit":true,"key":"g2NRu0WN9k"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The thermal conductivity is assumed to be given by:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LWfI0YddH1"}],"key":"gLcEHgwTfr"},{"type":"math","value":"k\\left(T\\right)={\\displaystyle \\frac{\\displaystyle 1}{\\displaystyle A+B\\,T}}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi\u003eA\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eB\u003c/mi\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\\left(T\\right)={\\displaystyle \\frac{\\displaystyle 1}{\\displaystyle A+B\\,T}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"OJTSyzB6CE"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"This expression accounts for the phononic contribution to the thermal\nconductivity.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rw52E4NNen"}],"key":"Usy3V5hg8k"},{"type":"heading","depth":3,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Derivatives","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"eOqiYckKCi"}],"identifier":"derivatives","label":"Derivatives","html_id":"derivatives","implicit":true,"key":"xWHfFAOfUd"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"As discussed below, the consistent linearisation of the heat transfer\nequilibrium requires to compute:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"gJdsRS6tl2"}],"key":"OfJGfLSUSk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the derivative\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"xVAwHePLNX"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"yodnIKWRXH"},{"type":"text","value":"\nof the heat flux with respect to the temperature gradient.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"sTkZBw26zj"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gd7Bam9u1s"},{"type":"text","value":"\nis given by: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"HUODFDOpBs"}],"key":"HEIH6CGMgb"},{"type":"math","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}=-k\\left(T\\right)\\,I","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmi\u003eI\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial \\mathbf{\\nabla} T}}=-k\\left(T\\right)\\,I\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\"\u003eI\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"Fi9MyFnVwL"}],"key":"NDrwhitW9e"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the derivative\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"AkV8WSETOa"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qWthzPbYw1"},{"type":"text","value":"\nof the heat flux with respect to the temperature.\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"wDtuR9KAYv"},{"type":"inlineMath","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GupJp4EogZ"},{"type":"text","value":"\nis given by: ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"IeTl1kk1dA"}],"key":"JfaxVA4efx"},{"type":"math","value":"{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}=-{\\displaystyle \\frac{\\displaystyle \\partial k\\left(T\\right)}{\\displaystyle \\partial T}}\\,\\mathbf{\\nabla} T=B\\,k^{2}\\,\\mathbf{\\nabla} T","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmfrac\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mstyle\u003e\u003c/mfrac\u003e\u003c/mstyle\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eB\u003c/mi\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmsup\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmi mathvariant=\"bold\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{\\displaystyle \\frac{\\displaystyle \\partial \\mathbf{j}}{\\displaystyle \\partial T}}=-{\\displaystyle \\frac{\\displaystyle \\partial k\\left(T\\right)}{\\displaystyle \\partial T}}\\,\\mathbf{\\nabla} T=B\\,k^{2}\\,\\mathbf{\\nabla} T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.427em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8641em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"YGEbXd23lA"}],"key":"KxtThHXh2H"}],"key":"FgEmnEzWY7"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"inlineCode","value":"MFront","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"PQeNMcaPlq"},{"type":"text","value":" implementation","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"R27jinOjkq"}],"identifier":"mfront-implementation","label":"MFront implementation","html_id":"mfront-implementation","implicit":true,"key":"RD92pHSpJK"},{"type":"heading","depth":3,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Choice of the the domain specific language","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"YygdFSUkkv"}],"identifier":"choice-of-the-the-domain-specific-language","label":"Choice of the the domain specific language","html_id":"choice-of-the-the-domain-specific-language","implicit":true,"key":"wL6UWg7cvv"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Every ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"k6ovA5qamP"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"kc2eyZymwN"},{"type":"text","value":" file is handled by a domain specific language (DSL), which\naims at providing the most suitable abstraction for a particular choice\nof behaviour and integration algorithm. See ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"iKRjjdmulH"},{"type":"inlineCode","value":"mfront mfront --list-dsl","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"bFHsINJ4JY"},{"type":"text","value":"\nfor a list of the available DSLs.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"dzEhKILX4b"}],"key":"YyCY2vDuh2"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"The name of DSL’s handling generic behaviours ends with\n","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"u5iChDjbpa"},{"type":"inlineCode","value":"GenericBehaviour","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"HQMBGxC9TS"},{"type":"text","value":". The first part of a DSL’s name is related to the\nintegration algorithm used.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Y17EnWP5XV"}],"key":"WVPEKylz4r"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"In the case of this non linear transfer behaviour, the heat flux is\nexplicitly computed from the temperature and the temperature gradient.\nThe ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fSqkUKcGkf"},{"type":"inlineCode","value":"DefaultGenericBehaviour","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"kP8W4d7DAC"},{"type":"text","value":" is the most suitable choice:","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"rGbMOr4LQq"}],"key":"FiDhlI3c2x"},{"type":"code","lang":"cpp","value":"@DSL DefaultGenericBehaviour;","position":{"start":{"line":65,"column":1},"end":{"line":67,"column":1}},"key":"IUU8Ez1fJB"},{"type":"heading","depth":3,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Some metadata","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"lE6Oyy7mCX"}],"identifier":"some-metadata","label":"Some metadata","html_id":"some-metadata","implicit":true,"key":"xEQAmSVmfg"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"The following lines define the name of the behaviour, the name of the\nauthor and the date of its writing:","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"ogBAVft9J7"}],"key":"NwpgywLuIt"},{"type":"code","lang":"cpp","value":"@Behaviour StationaryHeatTransfer;\n@Author Thomas Helfer;\n@Date 15/02/2019;","position":{"start":{"line":74,"column":1},"end":{"line":78,"column":1}},"key":"ftOx1BpT4W"},{"type":"heading","depth":3,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Gradients and fluxes","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"ocAkQe5dSn"}],"identifier":"gradients-and-fluxes","label":"Gradients and fluxes","html_id":"gradients-and-fluxes","implicit":true,"key":"VUveFddqQI"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Generic behaviours relate pairs of gradients and fluxes. Gradients and\nfluxes are declared independently but the first declared gradient is\nassumed to be conjugated with the first declared fluxes and so on…","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"FXSUoltj4a"}],"key":"lQYFM0cuK3"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"The temperature gradient is declared as follows (note that Unicode characters are supported):","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"KmTb0GOah2"}],"key":"ta02OmhJhR"},{"type":"code","lang":"cpp","value":"@Gradient TemperatureGradient ∇T;\n∇T.setGlossaryName(\"TemperatureGradient\");","position":{"start":{"line":88,"column":1},"end":{"line":91,"column":1}},"key":"UZWpFxocks"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Note that we associated to ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"YtvQyctNDt"},{"type":"inlineCode","value":"∇T","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"NPCgYvH2fK"},{"type":"text","value":" the glossary name ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"r9vGwyOsGK"},{"type":"inlineCode","value":"TemperatureGradient","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"N8hwtZDroh"},{"type":"text","value":".\nThis is helpful for the calling code.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"BT5aMaNLOj"}],"key":"Ckgz54oIrj"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"After this declaration, the following variables will be defined:","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"hIEILlepBe"}],"key":"JLZ5yLKaFv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":98,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The temperature gradient ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"RcENDg5gFP"},{"type":"inlineCode","value":"∇T","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"DTwELNa5SL"},{"type":"text","value":" at the beginning of the time step.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"uvGZszdKIF"}],"key":"zlktO59VdQ"}],"key":"BJS0utPwuB"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The increment of the temperature gradient ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"aVMyHjKNh9"},{"type":"inlineCode","value":"Δ∇T","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"gXgM3NazqI"},{"type":"text","value":" over the time step.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"wvuAebGafC"}],"key":"CKqQEWEG1Z"}],"key":"lQSMnlvMdH"}],"key":"BCcaQqy8eq"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"The heat flux is then declared as follows:","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"iua5e5fttB"}],"key":"tNvlsZl7Ia"},{"type":"code","lang":"cpp","value":"@Flux HeatFlux j;\nj.setGlossaryName(\"HeatFlux\");","position":{"start":{"line":103,"column":1},"end":{"line":106,"column":1}},"key":"d3gmtw2E1a"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"In the following code blocks, ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"RZ2EZDWhJL"},{"type":"inlineCode","value":"j","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"IYFZ6uRCqx"},{"type":"text","value":" will be the heat flux at the end of\nthe time step.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"sdmsY5xJLj"}],"key":"D2aHMiv8lr"},{"type":"heading","depth":3,"position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Tangent operator blocks","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"QA2U9yyHHy"}],"identifier":"tangent-operator-blocks","label":"Tangent operator blocks","html_id":"tangent-operator-blocks","implicit":true,"key":"eUgAwc0J6Z"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"By default, the derivatives of the gradients with respect to the fluxes\nare declared. Thus the variable ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"oHmAjmVk2j"},{"type":"inlineCode","value":"∂j∕∂Δ∇T","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"Kr8cZXYCmd"},{"type":"text","value":" is automatically declared.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"NWO97djNQ2"}],"key":"pyf3wt39xd"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"However, as discussed in the next section, the consistent linearisation\nof the thermal equilibrium requires to return the derivate of the heat\nflux with respect to the increment of the temperature (or equivalently\nwith respect to the temperature at the end of the time step).","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"D1q3XLB4MY"}],"key":"IBaet0Au1h"},{"type":"code","lang":"cpp","value":"@AdditionalTangentOperatorBlock ∂j∕∂ΔT;","position":{"start":{"line":121,"column":1},"end":{"line":123,"column":1}},"key":"jLu0COeROQ"},{"type":"heading","depth":3,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Parameters","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"NgtuqBUm2A"}],"identifier":"parameters","label":"Parameters","html_id":"parameters","implicit":true,"key":"nd5KyKPXfZ"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"XarJLVvlEp"},{"type":"inlineCode","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"bOQxSxK7yd"},{"type":"text","value":" and ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"BciCXh3HkK"},{"type":"inlineCode","value":"B","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"bCAeIUbUNn"},{"type":"text","value":" coefficients that appears in the definition of the\nthermal conductivity are declared as parameters:","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"SJIkkM9lFP"}],"key":"dpHidfXqhN"},{"type":"code","lang":"cpp","value":"@Parameter real A = 0.0375;\n@Parameter real B = 2.165e-4;","position":{"start":{"line":130,"column":1},"end":{"line":133,"column":1}},"key":"CsVmOH8Koz"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Parameters are stored globally and can be modified from the calling\nsolver or from ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"N1EUhqFhvo"},{"type":"inlineCode","value":"python","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"U9pxsOCF6Z"},{"type":"text","value":" in the case of the coupling with ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"EDm0B4jQ1a"},{"type":"inlineCode","value":"FEniCS","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"bg3piVmidc"},{"type":"text","value":"\ndiscussed below.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"vpegl2xaqS"}],"key":"K4HhpdSddm"},{"type":"heading","depth":3,"position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"Local variable","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"ihCgTVWazb"}],"identifier":"local-variable","label":"Local variable","html_id":"local-variable","implicit":true,"key":"IyOpElpwXo"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"A local variable is accessible in each code blocks.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"eBiuzW5ol2"}],"key":"sXjf7SKUh9"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Here, we declare the thermal conductivity ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"JbNBkX6Bl1"},{"type":"inlineCode","value":"k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"sk8n6SLlWQ"},{"type":"text","value":" as a local variable in\norder to be able to compute its value during the behaviour integration\nand to reuse this value when computing the tangent operator.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"y4wKjOferW"}],"key":"qcY56hGxqd"},{"type":"code","lang":"cpp","value":"@LocalVariable thermalconductivity k;","position":{"start":{"line":147,"column":1},"end":{"line":149,"column":1}},"key":"jLWWWN68Zz"},{"type":"heading","depth":3,"position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Integration of the behaviour","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"Wug0mrKKtS"}],"identifier":"integration-of-the-behaviour","label":"Integration of the behaviour","html_id":"integration-of-the-behaviour","implicit":true,"key":"q2HNx2loFO"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"The behaviour integration is straightforward: one starts to compute the\ntemperature at the end of the time step, then we compute the thermal\nconductivity (at the end of the time step) and the heat flux using the\ntemperature gradient (at the end of the time step).","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"DY20RyOVhr"}],"key":"xJkDhETXCk"},{"type":"code","lang":"cpp","value":"@Integrator{\n  // temperature at the end of the time step\n  const auto T_ = T + ΔT;\n  // thermal conductivity\n  k = 1 / (A + B ⋅ T_);\n  // heat flux\n  j = -k ⋅ (∇T + Δ∇T);\n} // end of @Integrator","position":{"start":{"line":158,"column":1},"end":{"line":167,"column":1}},"key":"kHsfeev6el"},{"type":"heading","depth":3,"position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Tangent operator","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"wEQrV8A49J"}],"identifier":"tangent-operator","label":"Tangent operator","html_id":"tangent-operator","implicit":true,"key":"JWYLawBgw8"},{"type":"paragraph","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"The computation of the tangent operator blocks is equally simple:","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"ROcNnolAfu"}],"key":"qfCzBenANY"},{"type":"code","lang":"cpp","value":"@TangentOperator {\n  ∂j∕∂Δ∇T = -k ⋅ tmatrix\u003cN, N, real\u003e::Id();\n  ∂j∕∂ΔT  =  B ⋅ k ⋅ k ⋅ (∇T + Δ∇T);\n} // end of @TangentOperator ","position":{"start":{"line":173,"column":1},"end":{"line":178,"column":1}},"key":"lAHLmqAADq"},{"type":"heading","depth":2,"position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"inlineCode","value":"FEniCSx","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"e8BerWtUO2"},{"type":"text","value":" implementation","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"y1RjPjwbjo"}],"identifier":"fenicsx-implementation","label":"FEniCSx implementation","html_id":"fenicsx-implementation","implicit":true,"key":"BhU6R5yzJz"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"We consider a rectanglar domain with imposed temperatures ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"x3QwAy808O"},{"type":"inlineCode","value":"Tl","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ouBW0dInw6"},{"type":"text","value":" (resp. ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZpbAYKToNT"},{"type":"inlineCode","value":"Tr","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZAxnWi3XsH"},{"type":"text","value":") on the left (resp. right) boundaries. We want to solve for the temperature field ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"P87tContUe"},{"type":"inlineCode","value":"T","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"xapobwEG5S"},{"type":"text","value":" inside the domain using a ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"nFKdtrXVUc"},{"type":"inlineMath","value":"P^1","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eP^1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"m83nNLxhMi"},{"type":"text","value":"-interpolation. We initialize the temperature at value ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Gqu04mvGiE"},{"type":"inlineCode","value":"Tl","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"rzkp6frdK6"},{"type":"text","value":" throughout the domain.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"DfFw9Md4Np"}],"key":"oGTkYRLmVJ"}],"key":"sn0CLzfEgY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport ufl\nfrom mpi4py import MPI\nfrom dolfinx import fem, mesh\nfrom dolfinx.cpp.nls.petsc import NewtonSolver\nfrom dolfinx_materials.quadrature_map import QuadratureMap\nfrom dolfinx_materials.solvers import NonlinearMaterialProblem\nfrom dolfinx_materials.material.mfront import MFrontMaterial\nimport os\n\n\ncurrent_path = os.getcwd()\n\nlength = 30e-3\nwidth = 5.4e-3\ndomain = mesh.create_rectangle(MPI.COMM_WORLD, [(0.0, 0.0), (length, width)], [100, 10])\n\nV = fem.functionspace(domain, (\"CG\", 1))\nT = fem.Function(V, name=\"Temperature\")\n\n\ndef left(x):\n    return np.isclose(x[0], 0)\n\n\ndef right(x):\n    return np.isclose(x[0], length)\n\n\nTl = 300.0\nTr = 800.0\nT.x.petsc_vec.set(Tl)\n\nleft_dofs = fem.locate_dofs_geometrical(V, left)\nright_dofs = fem.locate_dofs_geometrical(V, right)\n\nbcs = [fem.dirichletbc(Tl, left_dofs, V), fem.dirichletbc(Tr, right_dofs, V)]","key":"VjRivrd6ym"},{"type":"output","id":"DFw-OrKDv8A_lp3qnhQcd","data":[],"key":"KpaktM8AmP"}],"key":"ypnQ05cmQX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading the material behaviour","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TE8SELgu1F"}],"identifier":"loading-the-material-behaviour","label":"Loading the material behaviour","html_id":"loading-the-material-behaviour","implicit":true,"key":"NmQQ2PByuV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kRhkuNkE5o"},{"type":"inlineCode","value":"MFrontMaterial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mE3x4KA35E"},{"type":"text","value":" class for describing the material behaviour. The first argument corresponds to the path where material librairies have been compiled, the second correspond to the name of the behaviour (declared with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SwqKLTNCck"},{"type":"inlineCode","value":"@Behaviour","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V2nd2TICyl"},{"type":"text","value":"). Finally, the modelling hypothesis is specified (default behaviour is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wygQORn4aW"},{"type":"inlineCode","value":"\"3d\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wvbqd9OHsi"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yWvWqjPtRr"}],"key":"ZdbcS77Myf"}],"key":"KcoooufFuf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"material = MFrontMaterial(\n    os.path.join(current_path, \"src/libBehaviour.so\"),\n    \"StationaryHeatTransfer\",\n    hypothesis=\"plane_strain\",\n)","key":"vQgaeaAwLS"},{"type":"output","id":"zL03zeGuI5sz_6LM17qhq","data":[],"key":"XLkQgpa7Hq"}],"key":"sufTZqcD9x"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zVPAgEifYv"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NoFq2cRtyL"},{"type":"text","value":" behaviour declares the field ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m6fEoCJJeI"},{"type":"inlineCode","value":"\"TemperatureGradient\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AvsailRtZl"},{"type":"text","value":" as a Gradient variable, with its associated Flux called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hjZWMWskg5"},{"type":"inlineCode","value":"\"HeatFlux\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TamlZmAvTM"},{"type":"text","value":". We can check that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iXNHV5zGPF"},{"type":"inlineCode","value":"material","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ch4XMqBoFm"},{"type":"text","value":" object retrieves ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RUkci02Imv"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a1CQIBXufo"},{"type":"text","value":"’s gradient and flux names, as well as the different tangent operator blocks which have been defined, namely ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kjw9rOQ87F"},{"type":"inlineCode","value":"dj_ddgT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H7u7ZYCdwe"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJlT2KbVDi"},{"type":"inlineCode","value":"dj_ddT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q8TtHItZT1"},{"type":"text","value":" in the present case:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"batDxorSOQ"}],"key":"ZffCUKuO7n"}],"key":"MEvgDhxvjv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(material.gradients)\nprint(material.fluxes)\n\nprint([\"d{}_d{}\".format(*t) for t in material.tangent_blocks])","key":"XuolBVHe7L"},{"type":"output","id":"2BwqU4aJOF71BIPoF5uwR","data":[],"key":"hl5R33K04P"}],"key":"AocoAqrM3S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Non-linear problem definition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QDgupQ7Hg7"}],"identifier":"non-linear-problem-definition","label":"Non-linear problem definition","html_id":"non-linear-problem-definition","implicit":true,"key":"QXX4YOhC6G"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We now define the non-linear residual form that we want to solve. After defining test and trial functions, we instantiate the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GfJYS0uksu"},{"type":"inlineCode","value":"QuadratureMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ozHCoAuXbw"},{"type":"text","value":" object which will handle the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LsmRMlchsw"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"black-box","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NJyI66Eilh"}],"key":"Xl8zuVdlLi"},{"type":"text","value":" constitutive equation based on the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d99kh67BNt"},{"type":"inlineCode","value":"material","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N6xxdRC14b"},{"type":"text","value":" object. We must provide the requested quadrature degree which will control the number of quadrature points used in each cell to compute the non-linear constitutive law. Here, we specify a quadrature of degree 2 (i.e. 3 Gauss points for a triangular element).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fC3dqVUvH7"}],"key":"W36xZp5siK"}],"key":"RCvxDLGobR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"T_ = ufl.TestFunction(V)\ndT = ufl.TrialFunction(V)\n\ndeg_quad = 2\nqmap = QuadratureMap(domain, deg_quad, material)","key":"sl44UawZZw"},{"type":"output","id":"a_hWODiqcxalCZyj0LcJ2","data":[],"key":"VlLMTlwIOP"}],"key":"ncr0cXRzVp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Variable registration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"APUD4Ga2ZW"}],"identifier":"variable-registration","label":"Variable registration","html_id":"variable-registration","implicit":true,"key":"ug4NxnE7Nw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y8lc95tzF8"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ohFohlJPWZ"},{"type":"text","value":" behaviour implicitly declares the temperature as an external state variable called ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gCDDttdTgv"},{"type":"inlineCode","value":"\"Temperature\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ODI7egapXa"},{"type":"text","value":". We must therefore associate this external state variable to a known mechanical field. This can be achieved explicitly using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NX5xoeAbhT"},{"type":"inlineCode","value":"register_external_state_variable","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W7QubspAH1"},{"type":"text","value":" method.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ued0DA8pQh"}],"key":"ARdrIGpUhQ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For problems in which the temperature only acts as a parameter (no jacobian blocks with respect to the temperature), the temperature can be automatically registered as a constant value (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WJHJFi77EU"},{"type":"inlineMath","value":"293.15 \\text{ K}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e293.15\u003c/mn\u003e\u003cmtext\u003e K\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e293.15 \\text{ K}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e293.15\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003e K\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"x4Re0jQ7R0"},{"type":"text","value":" by default) or to any other (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TSzQGxv4Yj"},{"type":"inlineCode","value":"dolfin.Constant","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Rhk927ZwqP"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BGcXS3B63S"},{"type":"inlineCode","value":"float","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WjC8Rp600S"},{"type":"text","value":" or ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B6FqS4VZDl"},{"type":"inlineCode","value":"dolfin.Function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hcNlRMx5I3"},{"type":"text","value":") value using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CNpTWv7til"},{"type":"inlineCode","value":"register_external_state_variable","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hHiqiN0Hyf"},{"type":"text","value":" method.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DK1RVwUj2g"}],"key":"L5gKIbPAaB"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Finally, we need to associate to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I1zDQYJ5xw"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"v7b6uZyFQl"},{"type":"text","value":" gradient object the corresponding UFL expression as a function of the unknown field ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PTEPS2KOxb"},{"type":"inlineCode","value":"T","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Zupr72tGB1"},{"type":"text","value":". To do so, we use the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bdD0UDR5Q8"},{"type":"inlineCode","value":"register_gradient","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jwBGeOiiYQ"},{"type":"text","value":" method linking ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AboST7OUzX"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fT60Ja5Noo"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MuR5WnOC8n"},{"type":"inlineCode","value":"\"TemperatureGradient\"","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CGbBRFieLb"},{"type":"text","value":" object to the UFL expression ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mpJwbba6gi"},{"type":"inlineCode","value":"grad(T)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I4adNpPX1T"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UMOqJdQH4z"}],"key":"FZbS7O0JaJ"}],"key":"Cb5i4wy9p3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"qmap.register_external_state_variable(\"Temperature\", T)\nqmap.register_gradient(\"TemperatureGradient\", ufl.grad(T))","key":"wPDdJIxX7a"},{"type":"output","id":"fgnO4I6yTFFIw-zIz-NIq","data":[],"key":"wUqZMKIqRr"}],"key":"iwhc5LdIrx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nonlinear variational formulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HUlBZldVqC"}],"identifier":"nonlinear-variational-formulation","label":"Nonlinear variational formulation","html_id":"nonlinear-variational-formulation","implicit":true,"key":"RasTwZcSJL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are now in position of defining the nonlinear variational formulation corresponding to the stationary nonlinear heat transfer. Without any external loading, the nonlinear residual reads as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kw1yauLbwn"}],"key":"B4sMDnwBWo"},{"type":"math","value":"F(\\widehat{T}) = \\int_\\Omega \\mathbf{j}\\cdot \\nabla \\widehat{T} \\text{dx} = 0 \\quad \\forall \\widehat{T}","enumerated":true,"tight":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003eΩ\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmtext\u003edx\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmspace width=\"1em\"/\u003e\u003cmi mathvariant=\"normal\"\u003e∀\u003c/mi\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eF(\\widehat{T}) = \\int_\\Omega \\mathbf{j}\\cdot \\nabla \\widehat{T} \\text{dx} = 0 \\quad \\forall \\widehat{T}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1733em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eF\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9233em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:0.24em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'\u003e\u003cpath d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.2719em;vertical-align:-0.9119em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:-0.4336em;\"\u003e\u003cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eΩ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9119em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9233em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9233em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:0.24em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'\u003e\u003cpath d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003edx\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9233em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∀\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9233em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:0.24em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'\u003e\u003cpath d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"ZrxWTRtuoW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"where the heat flux ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NCurjpqmd4"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lWSaIq3Apr"},{"type":"text","value":" is provided by the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Gf34pUOJEo"},{"type":"inlineCode","value":"QuadratureMap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GIiTHi3eFw"},{"type":"text","value":" as a flux. The latter is a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O3aIUSEMxH"},{"type":"inlineCode","value":"dolfinx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QHPgDbM0tZ"},{"type":"text","value":" function defined on ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uLC3CXGAdX"},{"type":"inlineCode","value":"Quadrature","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KUzqYXqrjc"},{"type":"text","value":" function space (no interpolation is possible). Note that the integration measure must match the chosen quadrature scheme and quadrature degree. It is provided here as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Yvs82sX3iN"},{"type":"inlineCode","value":"qmap.dx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rC9BHYtSRP"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"c61FGl0hRA"}],"key":"G20win8cbz"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uK0oYlP1jZ"},{"type":"inlineCode","value":"qmap.derivative","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VWsJk609Pg"},{"type":"text","value":" function works similarly to the standard ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"d3ML0Fwr0W"},{"type":"inlineCode","value":"ufl.derivative","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jgm08hUEOg"},{"type":"text","value":" function except that it will also differentiate the heat flux. From the two tangent operator blocks ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kzi8iu11Zj"},{"type":"inlineCode","value":"dj_ddgT","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"r1Gx6hqE8e"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SoNio3PnAB"},{"type":"inlineCode","value":"dj_ddT","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GYW93nEUo2"},{"type":"text","value":", it will automatically be deduced that the heat flux ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xdj1MN321A"},{"type":"inlineMath","value":"\\mathbf{j}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"P5mna0eAqM"},{"type":"text","value":" is a function of both the temperature gradient ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tcPugIRfI5"},{"type":"inlineMath","value":"\\mathbf{g}=\\nabla T","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eg\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{g}=\\nabla T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003eg\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ktKLrmsy81"},{"type":"text","value":" and the temperature itself i.e. ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CzZHGmgExV"},{"type":"inlineMath","value":"\\mathbf{j}=\\mathbf{j}(\\mathbf{g}, T)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eg\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}=\\mathbf{j}(\\mathbf{g}, T)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003eg\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"yIYAV9msOk"},{"type":"text","value":". Hence, the computed Jacobian form will be:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lgdm6ygCwo"}],"key":"SqVxgaSaTU"},{"type":"math","value":"J(\\widehat{T},T^*) = \\int_{\\Omega} \\nabla \\widehat{T}\\cdot\\left(\\dfrac{\\partial \\mathbf{j}}{\\partial \\mathbf{g}}\\cdot \\nabla T^*+\\dfrac{\\partial \\mathbf{j}}{\\partial T}\\cdot T^*\\right) \\text{dx}","enumerated":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003eΩ\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003eg\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmtext\u003edx\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ(\\widehat{T},T^*) = \\int_{\\Omega} \\nabla \\widehat{T}\\cdot\\left(\\dfrac{\\partial \\mathbf{j}}{\\partial \\mathbf{g}}\\cdot \\nabla T^*+\\dfrac{\\partial \\mathbf{j}}{\\partial T}\\cdot T^*\\right) \\text{dx}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1733em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9233em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:0.24em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'\u003e\u003cpath d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7387em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.2719em;vertical-align:-0.9119em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:-0.4336em;\"\u003e\u003cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eΩ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9119em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9233em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:0.24em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'\u003e\u003cpath d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e(\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7387em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7387em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003edx\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"6","key":"imsQJzh5Bf"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The resulting nonlinear problem is managed by the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"aLEExDYWLZ"},{"type":"inlineCode","value":"NonlinearMaterialProblem","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rk6EUe6kKP"},{"type":"text","value":" class. It is solved using a Newton non-linear solver. The ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kjCq0S9dOZ"},{"type":"inlineCode","value":"solve","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mjYEcMBGz8"},{"type":"text","value":" method returns the converged status and the number of Newton iterations.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"bjJRQsykSQ"}],"key":"cE25qifAYa"}],"key":"deAv5honBe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"j = qmap.fluxes[\"HeatFlux\"]\n\nF = ufl.dot(j, ufl.grad(T_)) * qmap.dx\nJac = qmap.derivative(F, T, dT)\n\nproblem = NonlinearMaterialProblem(qmap, F, Jac, T, bcs)\n\nnewton = NewtonSolver(MPI.COMM_WORLD)\n\nconverged, it = problem.solve(newton)\n\n# Problem is weakly nonlinear, it should converge in a few iterations\nassert converged and it \u003c 10","key":"gWwLuQPNIr"},{"type":"output","id":"Docf-8s-ctsWMy4zDp-eS","data":[],"key":"qvodTCAa6J"}],"key":"KRF3R3lStr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We finally check that the thermal conductivity coefficient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"okhyxZEYpj"},{"type":"inlineMath","value":"k","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gMtneN6UaJ"},{"type":"text","value":", computed from the ratio between the horizontal heat flux and temperature gradient matches the temperature-dependent expressions implemented in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TaMrk0zAws"},{"type":"inlineCode","value":"MFront","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dJ5TdEQx0V"},{"type":"text","value":" behaviour.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P2d2FqwLGJ"}],"key":"Sm45WzgrqZ"}],"key":"DH9L71ARfk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"j_vals = j.x.array\ng_vals = qmap.gradients[\"TemperatureGradient\"].function.x.array\nk_gauss = -j_vals[::2] / g_vals[::2]\nT_gauss = qmap.external_state_variables[\"Temperature\"].function.x.array\nA = material.get_parameter(\"A\")\nB = material.get_parameter(\"B\")\nk_ref = 1 / (A + B * T_gauss)\nplt.plot(T_gauss, k_gauss, \"o\", label=\"FE\")\nplt.plot(T_gauss, k_ref, \".\", label=\"ref\")\nplt.xlabel(r\"Temperature $T\\: (K)$\")\nplt.ylabel(r\"Thermal conductivity $k\\: (W.m^{-1}.K^{-1})$\")\nplt.legend()\nplt.show()","key":"O054ybIT3B"},{"type":"output","id":"BjnkZig6IvIhaIxwjcAG9","data":[],"key":"VfJPlwqeZS"}],"key":"Ns0tdIZ5o6"}],"key":"lqW2iOomMi"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Introduction","url":"/introduction-2","group":"Demos coupling FEniCSx \u0026 MFront"},"next":{"title":"Poroelasticity","url":"/poroelasticity-2","group":"Demos coupling FEniCSx \u0026 MFront"}}},"domain":"http://localhost:3000"},"project":{"math":{"\\tens":{"macro":"\\underline{\\underline{#1}}"}},"title":"FEniCSx \u0026 MFront Gallery","description":"A gallery of projects with MFront and FEniCSx for coupled geomechanics problems","github":"https://github.com/Navier-Geotechnique/fenicsx-mfront-gallery","id":"4ecd091f-e698-428a-bac0-748b59b665a4","toc":[{"file":"home.md"},{"children":[{"file":"MFront/introduction.md"},{"file":"MFront/Elasticity.ipynb"},{"file":"MFront/poroelasticity.ipynb"},{"file":"MFront/poroplasticity.ipynb"}],"title":"Implementing material behaviors with MFront"},{"children":[{"file":"FEniCSx/introduction.md"},{"file":"FEniCSx/poisson.ipynb"},{"file":"FEniCSx/poroelasticity.ipynb"},{"children":[{"file":"FEniCSx/mixed_formulations.ipynb"},{"file":"FEniCSx/mixed_formulations_2.ipynb"}],"title":"Mixed Formulations"}],"title":"Finite Element Analysis with FEniCSx"},{"children":[{"file":"FEniCSx_Mfront/introduction.md"},{"file":"FEniCSx_Mfront/1_Nonlinear_Heat_Transfer/nonlinear_heat_transfer.ipynb"},{"file":"FEniCSx_Mfront/2_Poroelasticity/poroelasticity.ipynb"}],"title":"Demos coupling FEniCSx \u0026 MFront"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Implementing material behaviors with MFront"},{"slug":"introduction","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"elasticity","title":"A simple elastic behaviour","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity","title":"Poroelasticity: introduction to multiphysics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroplasticity","title":"Poroplasticity with the Cam-Clay model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Finite Element Analysis with FEniCSx"},{"slug":"introduction-1","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poisson","title":"Variational formulations: the Poisson equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-1","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Mixed Formulations"},{"slug":"mixed-formulations","title":"Why mixed formulations ?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"mixed-formulations-2","title":"Implementation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Demos coupling FEniCSx \u0026 MFront"},{"slug":"introduction-2","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-heat-transfer","title":"Stationary nonlinear heat transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"poroelasticity-2","title":"Poroelasticity","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/fenicsx-mfront-gallery/build/manifest-3481E987.js";
import * as route0 from "/fenicsx-mfront-gallery/build/root-7TUVC4ZT.js";
import * as route1 from "/fenicsx-mfront-gallery/build/routes/$-P6PGXPYX.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/fenicsx-mfront-gallery/build/entry.client-UNPC4GT3.js");</script></body></html>